Web VPython 3.2

# set scene
scene.background = color.white
scene.width = 1000
scene.height = 650
scene.range = 1

#constants (don't ask me when k is so low, I will change it later!!!)
K = 9E-7

# store all spawned charges
allChargedObjs = []

# Class Charge
class ChargedObj:
    def __init__(self, mass, charge, spawnPos, spawnVel):
        # physics variables
        self.charge = charge
        self.mass = mass
        self.pos = spawnPos
        self.vel = spawnVel
        # spheres for now
        if (charge < 0):
            self.display = sphere(pos=spawnPos, radius=0.05, color = color.red)
        if (charge > 0):
            self.display = sphere(pos=spawnPos, radius=0.05, color = color.blue)
        if (charge == 0):
            self.display = sphere(pos=spawnPos, radius=0.05, color = color.black)
    
    def applyForce(self):
        # calculate force from  every other charge
        force = vector(0, 0, 0)
        for chargedObj in allChargedObjs:
            if (chargedObj != self):
                if (mag(self.pos - chargedObj.pos) > 2 * self.display.radius):
                    force += calculateForce(self, chargedObj)
        # apply force
        self.vel += force / self.mass

    def applyVel(self):
        self.pos += self.vel
        self.display.pos = self.pos
    
    def checkCollision(self):
        for chargedObj in allChargedObjs:
            if (mag(self.pos - chargedObj.pos) <= 2 * self.display.radius):
                self.vel = vector(0, 0, 0)
                chargedObj.vel = vector(0, 0, 0)

# Coulomb's Law
def calculateForce(q1, q2):
    r12 = q1.pos - q2.pos
    return norm(r12) * K * q1.charge * q2.charge / (mag(r12)**2)

####################################################################################################

# Clicks
def clicked():
    if (clickMode == "Spawn"):
        makeChargeObj()
    # elif (clickMode == "Select"):
    #     selectCharge()

scene.bind('click', clicked)

def makeChargeObj():
    allChargedObjs.append(ChargedObj(1, spawnCharge, getMousePos(), vector(0, 0, 0)))

def chargedObjOnMouse():
    mousePos = getMousePos()
    for chargedObj in allChargedObjs:
        if (mag(mousePos - chargedObj.pos) <= chargedObj.display.radius):
            # chargedObj.display.color = color.green
            return chargedObj
        
def getMousePos():
    return scene.mouse.project(normal=vector(0, 0, 1))

# dragging
chargedObjToDrag = undefined

def on_mouse_down():
    global chargedObjToDrag
    chargedObjToDrag = chargedObjOnMouse()

def on_mouse_up():
    global chargedObjToDrag
    chargedObjToDrag = undefined

def on_mouse_move():
    if chargedObjToDrag != undefined:
        chargedObjToDrag.pos = getMousePos()
        chargedObjToDrag.display.pos = chargedObjToDrag.pos

# Bind event handlers to the box
scene.bind('mousedown', on_mouse_down)
scene.bind('mouseup', on_mouse_up)
scene.bind('mousemove', on_mouse_move)

####################################################################################################

# Button and Sliders

# mode button
clickMode = "Spawn"

def changeClickModeButton():
    global clickMode, clickModeButton
    if clickMode == "Spawn":
        clickMode = "Select"
    else:
        clickMode = "Spawn"
    clickModeButton.text = "Mode: " + clickMode

scene.append_to_caption("   ")
clickModeButton = button(text="Mode: Spawn", bind=changeClickModeButton)

# spawn slider
spawnCharge = -1

def spawnChargeShift():
    global spawnCharge, spawnChargeText
    spawnCharge = s.value
    spawnChargeText.text = 'Charge:'+'{:1.2f}'.format(s.value)

s = slider(bind = spawnChargeShift, min = -5, max = 5, value = -1)
spawnChargeText = wtext(text = 'Charge:'+'{:1.2f}'.format(s.value))

# playing button
playing = False

def changePlayButton():
    global playing, playButton
    playing = not playing
    if playing:
        playButton.text = "Stop"
    else:
        playButton.text = "Play"

scene.append_to_caption("   ")
playButton = button(text="Play", bind=changePlayButton)

while True:
    rate(1000)
    if (playing):
        for chargedObj in allChargedObjs:
            chargedObj.applyForce()
        for chargedObj in allChargedObjs:
            chargedObj.applyVel()
    # for charge in allChargedObjs:
    #     charge.checkCollision()
        
